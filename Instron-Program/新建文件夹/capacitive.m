clc;clear;
load ('terrain09_group4_duration0p5s_5.lvm');
label = 9;
fs1=22000;
Num=[-0.000311118476735336,0.00117464849830931,0.00144304897436479,-0.000296191258532085,-0.00204067673209557,-0.00118780621970690,0.000501913666103730,0.000173210409452585,5.14855364154363e-05,0.00303028375840465,0.00434859409697169,-0.00192727643564742,-0.00937067433847594,-0.00562463326593913,0.00663170670141666,0.0107225902455296,0.00157409368782132,-0.00656280838503625,-0.00398039957759261,0.000693137483986037,-0.000844534026837883,-0.00217158561677778,0.00248872023264825,0.00560520370682949,0.00133498821653268,-0.00280059023462308,-0.00110091158738904,-0.000374064970045310,-0.00416455755203054,-0.00370209713662424,0.00400345511287756,0.00746726225179131,0.00146161790053064,-0.00304388397374757,-0.000410020286596799,-0.000380516378949930,-0.00601422853322020,-0.00519500636947564,0.00470454822842662,0.00870535465656014,0.00173236674600542,-0.00228196968816348,0.00125312046332822,-0.000693120358720253,-0.00916075116866691,-0.00734507908958167,0.00583674122250333,0.0102838973261723,0.00187773970575444,-0.00109750624763679,0.00389204347272072,-0.000947213845145936,-0.0134321103359500,-0.0102713281949463,0.00708671372893963,0.0117892679269216,0.00181273098273702,0.00115753597387550,0.00833144058831388,-0.00120874803350767,-0.0197033694238836,-0.0144638635864951,0.00863486170814224,0.0131392704716123,0.00125263027807615,0.00533182696095164,0.0162355023752464,-0.00143164057068919,-0.0300284802541664,-0.0213132702136170,0.0109057760162776,0.0141982419463485,-0.000534684392320380,0.0142373392593170,0.0333069666432797,-0.00159822640175943,-0.0527648078095298,-0.0368825786336832,0.0161336982296911,0.0148782574165599,-0.00741683525967204,0.0454820261100927,0.101666484247000,-0.00168683487626026,-0.186389978535707,-0.165544990595033,0.0991651495287439,0.265104977256699,0.0991651495287439,-0.165544990595033,-0.186389978535707,-0.00168683487626026,0.101666484247000,0.0454820261100927,-0.00741683525967204,0.0148782574165599,0.0161336982296911,-0.0368825786336832,-0.0527648078095298,-0.00159822640175943,0.0333069666432797,0.0142373392593170,-0.000534684392320380,0.0141982419463485,0.0109057760162776,-0.0213132702136170,-0.0300284802541664,-0.00143164057068919,0.0162355023752464,0.00533182696095164,0.00125263027807615,0.0131392704716123,0.00863486170814224,-0.0144638635864951,-0.0197033694238836,-0.00120874803350767,0.00833144058831388,0.00115753597387550,0.00181273098273702,0.0117892679269216,0.00708671372893963,-0.0102713281949463,-0.0134321103359500,-0.000947213845145936,0.00389204347272072,-0.00109750624763679,0.00187773970575444,0.0102838973261723,0.00583674122250333,-0.00734507908958167,-0.00916075116866691,-0.000693120358720253,0.00125312046332822,-0.00228196968816348,0.00173236674600542,0.00870535465656014,0.00470454822842662,-0.00519500636947564,-0.00601422853322020,-0.000380516378949930,-0.000410020286596799,-0.00304388397374757,0.00146161790053064,0.00746726225179131,0.00400345511287756,-0.00370209713662424,-0.00416455755203054,-0.000374064970045310,-0.00110091158738904,-0.00280059023462308,0.00133498821653268,0.00560520370682949,0.00248872023264825,-0.00217158561677778,-0.000844534026837883,0.000693137483986037,-0.00398039957759261,-0.00656280838503625,0.00157409368782132,0.0107225902455296,0.00663170670141666,-0.00562463326593913,-0.00937067433847594,-0.00192727643564742,0.00434859409697169,0.00303028375840465,5.14855364154363e-05,0.000173210409452585,0.000501913666103730,-0.00118780621970690,-0.00204067673209557,-0.000296191258532085,0.00144304897436479,0.00117464849830931,-0.000311118476735336];

acoustic_data = terrain09_group4_duration0p5s_5(:,2);
capacitive_data = terrain09_group4_duration0p5s_5(:,3);
bbb=1;
acoustic_data = acoustic_data(bbb:end);
capacitive_data = capacitive_data (bbb:end);
capacitive_data (:)=4-capacitive_data(:);
size_capacitive=size(capacitive_data);
figure (1);
plot (capacitive_data);
for i=1:size_capacitive
    if (capacitive_data(i)<3.6)
        capacitive_data(i)=3.6;
    end
end




figure (2);
size_acoustic = size (acoustic_data);
acoustic_data=filter (Num,1,acoustic_data);
plot (acoustic_data);
dd=0;
% flag = 0;
% be=1;
% for i=1:size_acoustic(1)
%     if abs(acoustic_data(i))>0.023
%         y1(be:i)=1;
%         be=i+1;
%         flag=1;
%         dd=0;
%     else
%         if flag==1
%             be = i;
%             flag = 0;
%         else
%             if dd>3000
%                 y1(be:i)=0;
%                 be=i+1;
%             else
%                 y1(be:i)=1;
%             end
%             dd=dd+1; 
%         end
%     end
% end
% flag=0;
% k=0;
% k2=0;
% be=1;
% en=1;
% data= zeros(100,200000);
% for i=1:size_acoustic(1)
%     if flag==0&&y1(i)==1
%         be=i;
%         flag=1;
% 
%         %seg2_data{k}=x1(en:be);
%     elseif flag==1&&y1(i)==0
%         en = i;
%         flag=0;
%         if ((en-be)>2000)
%             k=k+1;
%             en=en+8000;
%             seg_data1{k}=capacitive_data(be:en);
%         else
%             be=i+1;
%         end
% 
%         %data(k,1:en-be+1)=x1(be:en);
% %          figure (k);
% %          plot (data(k,:));
%         %sound (data(k,:),fs1);
%         %pause(3);
%     end
% end
% p = size(seg_data1);
% for i=1:p(2)
%     a=seg_data1{i};
%     seg_data{i}=a(1:end);
% end


iii=1;
aa=input('aa=');
bb=input('bb=');
for i=aa:fix((bb-aa)/48):bb
    seg_data{iii}=acoustic_data(i:i+fix((bb-aa)/48/1.3));
    iii=iii+1;
end
p = size(seg_data);







dd=0;
flag = 0;
be=1;
% for i=1:size_capacitive(1)
%     if abs(capacitive_data(i))>3.6
%         y1(be:i)=1;
%         be=i+1;
%         flag=1;
%         dd=0;
%     else
%         if flag==1
%             be = i;
%             flag = 0;
%         else
%             if dd>3000
%                 y1(be:i)=0;
%                 be=i+1;
%             else
%                 y1(be:i)=1;
%             end
%             dd=dd+1; 
%         end
%     end
% end
% flag=0;
% k=0;
% k2=0;
% be=1;
% en=1;
% data= zeros(100,200000);
% for i=1:size_capacitive(1)
%     if flag==0&&y1(i)==1
%         be=i;
%         flag=1;
%         %seg2_data{k}=x1(en:be);
%     elseif flag==1&&y1(i)==0
%         en = i;
%         flag=0;
%         if ((en-be)>3500)
%             k=k+1;
%             be=max(be-8000,1);
%             en=min(en+8000,size_capacitive(1));
%             seg_data1{k}=capacitive_data(be:en);
%         else
%             be=i+1;
%         end
%     end
% end
% 

% if mod (p(2),2)==1
%     j=2;
% else
%     j=1;
% end

j=1;
file_capacitive_data = fopen('capacitive_data_tem.txt','w');

for kn=j:2:p(2)
capacitive_wdata= seg_data{kn};
fprintf (file_capacitive_data,'%d ',label);
fprintf (file_capacitive_data,'%d ',length(capacitive_wdata));
fprintf (file_capacitive_data,'%f ',capacitive_wdata);
fprintf (file_capacitive_data,'\n');
end
%fprintf (file_capacitive_data,'-1');
fprintf (file_capacitive_data,'\n');
fprintf (file_capacitive_data,'\n');
fprintf (file_capacitive_data,'\n');
fprintf (file_capacitive_data,'\n');
fprintf (file_capacitive_data,'\n');


fclose (file_capacitive_data);


